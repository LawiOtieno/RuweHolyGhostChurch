
{% extends 'base.html' %}

{% block title %}Church Structure - RuweHolyGhostChurch{% endblock %}

{% block page_title %}Church Structure{% endblock %}

{% block content %}
<!-- Quick Add Section -->
<div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 30px; margin-bottom: 30px;">
    <!-- Diocese Management -->
    <div class="card">
        <div class="card-header">
            <h5 class="card-title">
                <i class="fas fa-church" style="color: #dc2626; margin-right: 10px;"></i>
                Diocese Management
            </h5>
        </div>
        <div style="padding: 20px;">
            <div style="text-align: center; margin-bottom: 20px;">
                <a href="{% url 'church_structure:add_diocese' %}" class="btn btn-primary" style="width: 100%; padding: 15px;">
                    <i class="fas fa-plus" style="margin-right: 8px;"></i>
                    Add New Diocese
                </a>
            </div>
            
            <div class="dioceses-list">
                <h6 style="color: #ffffff; margin-bottom: 15px; text-align: center;">Recent Dioceses</h6>
                {% for diocese in dioceses|slice:":5" %}
                <div style="background: rgba(255,255,255,0.05); padding: 12px; margin-bottom: 10px; border-radius: 6px; border-left: 3px solid #dc2626;">
                    <div style="display: flex; justify-content: between; align-items: flex-start;">
                        <div style="flex: 1;">
                            <strong style="color: #ffffff; display: block;">{{ diocese.name }}</strong>
                            <span style="color: #22c55e; font-size: 0.8em;">{{ diocese.identifier }}</span><br>
                            <small style="color: #9ca3af;">{{ diocese.country }}</small><br>
                            <small style="color: #e5e7eb;">Bishop: {{ diocese.bishop_name }}</small>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <a href="{% url 'church_structure:diocese_detail' diocese_slug=diocese.slug %}" 
                               style="background: #3b82f6; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px; font-size: 0.8em;"
                               title="View Details">
                                <i class="fas fa-eye"></i>
                            </a>
                            <a href="{% url 'church_structure:edit_diocese' diocese_slug=diocese.slug %}" 
                               style="background: #f59e0b; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px; font-size: 0.8em;"
                               title="Edit">
                                <i class="fas fa-edit"></i>
                            </a>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div style="text-align: center; padding: 20px; color: #9ca3af;">
                    <i class="fas fa-church" style="font-size: 2rem; margin-bottom: 10px; opacity: 0.5;"></i>
                    <p style="font-style: italic; margin: 0;">No dioceses added yet.</p>
                </div>
                {% endfor %}
                
                {% if dioceses.count > 5 %}
                <div style="text-align: center; margin-top: 15px;">
                    <small style="color: #9ca3af;">Showing 5 of {{ dioceses.count }} dioceses</small>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Pastorate Management -->
    <div class="card">
        <div class="card-header">
            <h5 class="card-title">
                <i class="fas fa-users" style="color: #dc2626; margin-right: 10px;"></i>
                Pastorate Management
            </h5>
        </div>
        <div style="padding: 20px;">
            <div style="text-align: center; margin-bottom: 20px;">
                <a href="{% url 'church_structure:add_pastorate' %}" class="btn btn-success" style="width: 100%; padding: 15px;">
                    <i class="fas fa-plus" style="margin-right: 8px;"></i>
                    Add New Pastorate
                </a>
            </div>
            
            <div class="pastorates-list">
                <h6 style="color: #ffffff; margin-bottom: 15px; text-align: center;">Recent Pastorates</h6>
                {% for pastorate in pastorates|slice:":5" %}
                <div style="background: rgba(255,255,255,0.05); padding: 12px; margin-bottom: 10px; border-radius: 6px; border-left: 3px solid #3b82f6;">
                    <div style="display: flex; justify-content: between; align-items: flex-start;">
                        <div style="flex: 1;">
                            <strong style="color: #ffffff; display: block;">{{ pastorate.name }}</strong>
                            <span style="color: #22c55e; font-size: 0.8em;">{{ pastorate.identifier }}</span><br>
                            <small style="color: #e5e7eb;">Pastor: {{ pastorate.pastor_name }}</small><br>
                            <small style="color: #dc2626;">Diocese: {{ pastorate.diocese.name }}</small>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <a href="{% url 'church_structure:pastorate_detail' pastorate_slug=pastorate.slug %}" 
                               style="background: #3b82f6; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px; font-size: 0.8em;"
                               title="View Details">
                                <i class="fas fa-eye"></i>
                            </a>
                            <a href="{% url 'church_structure:edit_pastorate' pastorate_slug=pastorate.slug %}" 
                               style="background: #f59e0b; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px; font-size: 0.8em;"
                               title="Edit">
                                <i class="fas fa-edit"></i>
                            </a>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div style="text-align: center; padding: 20px; color: #9ca3af;">
                    <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 10px; opacity: 0.5;"></i>
                    <p style="font-style: italic; margin: 0;">No pastorates added yet.</p>
                </div>
                {% endfor %}
                
                {% if pastorates.count > 5 %}
                <div style="text-align: center; margin-top: 15px;">
                    <small style="color: #9ca3af;">Showing 5 of {{ pastorates.count }} pastorates</small>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Church Management -->
    <div class="card">
        <div class="card-header">
            <h5 class="card-title">
                <i class="fas fa-home" style="color: #dc2626; margin-right: 10px;"></i>
                Church Management
            </h5>
        </div>
        <div style="padding: 20px;">
            <div style="text-align: center; margin-bottom: 20px;">
                <a href="{% url 'church_structure:add_church' %}" class="btn btn-info" style="width: 100%; padding: 15px;">
                    <i class="fas fa-plus" style="margin-right: 8px;"></i>
                    Add New Church
                </a>
            </div>
            
            <div class="churches-list">
                <h6 style="color: #ffffff; margin-bottom: 15px; text-align: center;">Recent Churches</h6>
                {% for church in churches|slice:":5" %}
                <div style="background: rgba(255,255,255,0.05); padding: 12px; margin-bottom: 10px; border-radius: 6px; border-left: 3px solid #16a34a;">
                    <div style="display: flex; justify-content: between; align-items: flex-start;">
                        <div style="flex: 1;">
                            <strong style="color: #ffffff; display: block;">{{ church.name }}</strong>
                            <span style="color: #22c55e; font-size: 0.8em;">{{ church.identifier }}</span><br>
                            <small style="color: #9ca3af;">{{ church.address|truncatechars:30 }}</small><br>
                            <small style="color: #e5e7eb;">Head Teacher: {{ church.head_teacher_name }}</small><br>
                            <small style="color: #dc2626;">Pastorate: {{ church.pastorate.name }}</small>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <a href="{% url 'church_structure:church_detail' church_slug=church.slug %}" 
                               style="background: #3b82f6; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px; font-size: 0.8em;"
                               title="View Details">
                                <i class="fas fa-eye"></i>
                            </a>
                            <a href="{% url 'church_structure:edit_church' church_slug=church.slug %}" 
                               style="background: #f59e0b; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px; font-size: 0.8em;"
                               title="Edit">
                                <i class="fas fa-edit"></i>
                            </a>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div style="text-align: center; padding: 20px; color: #9ca3af;">
                    <i class="fas fa-home" style="font-size: 2rem; margin-bottom: 10px; opacity: 0.5;"></i>
                    <p style="font-style: italic; margin: 0;">No churches added yet.</p>
                </div>
                {% endfor %}
                
                {% if churches.count > 5 %}
                <div style="text-align: center; margin-top: 15px;">
                    <small style="color: #9ca3af;">Showing 5 of {{ churches.count }} churches</small>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Professional Church Structure Table -->
<div class="card" style="margin-top: 30px;">
    <div class="card-header">
        <h5 class="card-title">
            <i class="fas fa-sitemap" style="color: #dc2626; margin-right: 10px;"></i>
            Church Hierarchical Structure Overview
        </h5>
    </div>
    <div style="margin-top: 20px;">
        <div style="text-align: center; margin-bottom: 30px;">
            <div style="background: #dc2626; color: white; padding: 15px; border-radius: 8px; display: inline-block;">
                <i class="fas fa-crown" style="margin-right: 10px;"></i>
                <strong>HEADQUARTERS - RUWE</strong><br>
                <small>Archbishop Leadership</small>
            </div>
        </div>
        
        {% if dioceses %}
        <div class="table-responsive">
            <table class="table table-dark table-striped" style="background: #1f2937; table-layout: fixed; width: 100%;">
                <thead style="background: #dc2626;">
                    <tr>
                        <th style="padding: 15px; color: white; border: 1px solid #374151; width: 33.33%;">
                            <i class="fas fa-church" style="margin-right: 8px;"></i>
                            Diocese
                        </th>
                        <th style="padding: 15px; color: white; border: 1px solid #374151; width: 33.33%;">
                            <i class="fas fa-users" style="margin-right: 8px;"></i>
                            Pastorate
                        </th>
                        <th style="padding: 15px; color: white; border: 1px solid #374151; width: 33.34%;">
                            <i class="fas fa-home" style="margin-right: 8px;"></i>
                            Church
                        </th>
                    </tr>
                </thead>
                <tbody>
                    {% for diocese in dioceses %}
                        {% for pastorate in diocese.pastorates.all %}
                            {% for church in pastorate.churches.all %}
                            <tr>
                                <td style="padding: 12px; border: 1px solid #374151; background: rgba(220, 38, 38, 0.1); vertical-align: top;">
                                    <div style="margin-bottom: 8px;">
                                        <strong style="color: #ffffff; font-size: 1.1em;">{{ diocese.name }}</strong><br>
                                        <span style="color: #22c55e; font-size: 0.8em;">{{ diocese.identifier }}</span><br>
                                        <small style="color: #9ca3af;">{{ diocese.country }}</small><br>
                                        <small style="color: #e5e7eb;">Bishop: {{ diocese.bishop_name }}</small>
                                    </div>
                                    <div style="margin-top: 10px;">
                                        <a href="{% url 'church_structure:diocese_detail' diocese_slug=diocese.slug %}" 
                                           class="btn btn-sm" style="background: #3b82f6; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="View Diocese Details">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <a href="{% url 'church_structure:edit_diocese' diocese_slug=diocese.slug %}" 
                                           class="btn btn-sm" style="background: #f59e0b; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Edit Diocese">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'church_structure:delete_diocese' diocese_slug=diocese.slug %}" 
                                           class="btn btn-sm" style="background: #ef4444; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Delete Diocese"
                                           onclick="return confirm('Are you sure you want to delete this diocese?')">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </div>
                                </td>
                                
                                <td style="padding: 12px; border: 1px solid #374151; background: rgba(59, 130, 246, 0.1); vertical-align: top;">
                                    <div style="margin-bottom: 8px;">
                                        <strong style="color: #ffffff; font-size: 1.05em;">{{ pastorate.name }}</strong><br>
                                        <span style="color: #22c55e; font-size: 0.8em;">{{ pastorate.identifier }}</span><br>
                                        <small style="color: #e5e7eb;">Pastor: {{ pastorate.pastor_name }}</small>
                                    </div>
                                    <div style="margin-top: 10px;">
                                        <a href="{% url 'church_structure:pastorate_detail' pastorate_slug=pastorate.slug %}" 
                                           class="btn btn-sm" style="background: #3b82f6; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="View Pastorate Details">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <a href="{% url 'church_structure:edit_pastorate' pastorate_slug=pastorate.slug %}" 
                                           class="btn btn-sm" style="background: #f59e0b; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Edit Pastorate">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'church_structure:delete_pastorate' pastorate_slug=pastorate.slug %}" 
                                           class="btn btn-sm" style="background: #ef4444; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Delete Pastorate"
                                           onclick="return confirm('Are you sure you want to delete this pastorate?')">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </div>
                                </td>
                                
                                <td style="padding: 12px; border: 1px solid #374151; background: rgba(16, 185, 129, 0.1); vertical-align: top;">
                                    <div style="margin-bottom: 8px;">
                                        <strong style="color: #ffffff;">{{ church.name }}</strong><br>
                                        <span style="color: #22c55e; font-size: 0.8em;">{{ church.identifier }}</span><br>
                                        <small style="color: #9ca3af;">{{ church.address }}</small><br>
                                        <small style="color: #e5e7eb;">Head Teacher: {{ church.head_teacher_name }}</small>
                                    </div>
                                    <div style="margin-top: 10px;">
                                        <a href="{% url 'church_structure:church_detail' church_slug=church.slug %}" 
                                           class="btn btn-sm" style="background: #3b82f6; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="View Church Details">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <a href="{% url 'church_structure:edit_church' church_slug=church.slug %}" 
                                           class="btn btn-sm" style="background: #f59e0b; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Edit Church">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'church_structure:delete_church' church_slug=church.slug %}" 
                                           class="btn btn-sm" style="background: #ef4444; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Delete Church"
                                           onclick="return confirm('Are you sure you want to delete this church?')">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td style="padding: 12px; border: 1px solid #374151; background: rgba(220, 38, 38, 0.1); vertical-align: top;">
                                    <div style="margin-bottom: 8px;">
                                        <strong style="color: #ffffff; font-size: 1.1em;">{{ diocese.name }}</strong><br>
                                        <span style="color: #22c55e; font-size: 0.8em;">{{ diocese.identifier }}</span><br>
                                        <small style="color: #9ca3af;">{{ diocese.country }}</small><br>
                                        <small style="color: #e5e7eb;">Bishop: {{ diocese.bishop_name }}</small>
                                    </div>
                                    <div style="margin-top: 10px;">
                                        <a href="{% url 'church_structure:diocese_detail' diocese_slug=diocese.slug %}" 
                                           class="btn btn-sm" style="background: #3b82f6; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="View Diocese Details">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <a href="{% url 'church_structure:edit_diocese' diocese_slug=diocese.slug %}" 
                                           class="btn btn-sm" style="background: #f59e0b; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Edit Diocese">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'church_structure:delete_diocese' diocese_slug=diocese.slug %}" 
                                           class="btn btn-sm" style="background: #ef4444; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Delete Diocese"
                                           onclick="return confirm('Are you sure you want to delete this diocese?')">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </div>
                                </td>
                                
                                <td style="padding: 12px; border: 1px solid #374151; background: rgba(59, 130, 246, 0.1); vertical-align: top;">
                                    <div style="margin-bottom: 8px;">
                                        <strong style="color: #ffffff; font-size: 1.05em;">{{ pastorate.name }}</strong><br>
                                        <span style="color: #22c55e; font-size: 0.8em;">{{ pastorate.identifier }}</span><br>
                                        <small style="color: #e5e7eb;">Pastor: {{ pastorate.pastor_name }}</small>
                                    </div>
                                    <div style="margin-top: 10px;">
                                        <a href="{% url 'church_structure:pastorate_detail' pastorate_slug=pastorate.slug %}" 
                                           class="btn btn-sm" style="background: #3b82f6; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="View Pastorate Details">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <a href="{% url 'church_structure:edit_pastorate' pastorate_slug=pastorate.slug %}" 
                                           class="btn btn-sm" style="background: #f59e0b; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Edit Pastorate">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'church_structure:delete_pastorate' pastorate_slug=pastorate.slug %}" 
                                           class="btn btn-sm" style="background: #ef4444; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                           title="Delete Pastorate"
                                           onclick="return confirm('Are you sure you want to delete this pastorate?')">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </div>
                                </td>
                                
                                <td style="padding: 12px; border: 1px solid #374151; background: rgba(16, 185, 129, 0.1); color: #9ca3af; font-style: italic; vertical-align: top;">
                                    <i class="fas fa-info-circle" style="margin-right: 5px;"></i>
                                    No churches in this pastorate yet
                                </td>
                            </tr>
                            {% endfor %}
                        {% empty %}
                        <tr>
                            <td style="padding: 12px; border: 1px solid #374151; background: rgba(220, 38, 38, 0.1); vertical-align: top;">
                                <div style="margin-bottom: 8px;">
                                    <strong style="color: #ffffff; font-size: 1.1em;">{{ diocese.name }}</strong><br>
                                    <span style="color: #22c55e; font-size: 0.8em;">{{ diocese.identifier }}</span><br>
                                    <small style="color: #9ca3af;">{{ diocese.country }}</small><br>
                                    <small style="color: #e5e7eb;">Bishop: {{ diocese.bishop_name }}</small>
                                </div>
                                <div style="margin-top: 10px;">
                                    <a href="{% url 'church_structure:diocese_detail' diocese_slug=diocese.slug %}" 
                                       class="btn btn-sm" style="background: #3b82f6; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                       title="View Diocese Details">
                                        <i class="fas fa-eye"></i>
                                    </a>
                                    <a href="{% url 'church_structure:edit_diocese' diocese_slug=diocese.slug %}" 
                                       class="btn btn-sm" style="background: #f59e0b; color: white; margin-right: 5px; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                       title="Edit Diocese">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <a href="{% url 'church_structure:delete_diocese' diocese_slug=diocese.slug %}" 
                                       class="btn btn-sm" style="background: #ef4444; color: white; padding: 4px 8px; text-decoration: none; border-radius: 4px;"
                                       title="Delete Diocese"
                                       onclick="return confirm('Are you sure you want to delete this diocese?')">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                </div>
                            </td>
                            <td style="padding: 12px; border: 1px solid #374151; background: rgba(59, 130, 246, 0.1); color: #9ca3af; font-style: italic; vertical-align: top;" colspan="2">
                                <i class="fas fa-info-circle" style="margin-right: 5px;"></i>
                                No pastorates in this diocese yet
                            </td>
                        </tr>
                        {% endfor %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div style="text-align: center; color: #9ca3af; font-style: italic; padding: 40px;">
            <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
            No church structure data available yet. Start by adding dioceses.
        </div>
        {% endif %}
        
        <!-- Quick Add Buttons -->
        <div style="margin-top: 30px; text-align: center;">
            <a href="{% url 'church_structure:add_diocese' %}" class="btn btn-primary" style="margin: 5px;">
                <i class="fas fa-plus"></i> Add Diocese
            </a>
            <a href="{% url 'church_structure:add_pastorate' %}" class="btn btn-success" style="margin: 5px;">
                <i class="fas fa-plus"></i> Add Pastorate
            </a>
            <a href="{% url 'church_structure:add_church' %}" class="btn btn-info" style="margin: 5px;">
                <i class="fas fa-plus"></i> Add Church
            </a>
        </div>
    </div>
</div>


{% endblock %}
