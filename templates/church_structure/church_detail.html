{% extends 'base.html' %}

{% block title %}{{ church.name }} Church - RuweHolyGhostChurch{% endblock %}

{% block page_title %}{{ church.name }} Church{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <!-- Church Information Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title">
                    <i class="fas fa-home" style="color: #dc2626; margin-right: 10px;"></i>
                    Church Information
                </h5>
                <div style="float: right;">
                    <a href="{% url 'church_structure:edit_church' church_slug=church.slug %}"
                       class="btn btn-primary btn-sm">
                        <i class="fas fa-edit"></i> Edit Church
                    </a>
                    <a href="{% url 'church_structure:pastorate_detail' pastorate_slug=church.pastorate.slug %}"
                       class="btn btn-primary btn-sm">
                        <i class="fas fa-users"></i> View Pastorate
                    </a>
                    <a href="{% url 'church_structure:index' %}" class="btn btn-secondary btn-sm">
                        <i class="fas fa-arrow-left"></i> Back
                    </a>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Church Name:</strong> {{ church.name }}</p>
                        <p><strong>Identifier:</strong> {{ church.identifier }}</p>
                        <p><strong>Pastorate:</strong> {{ church.pastorate.name }}</p>
                        <p><strong>Diocese:</strong> {{ church.pastorate.diocese.name }}</p>
                        <p><strong>Location:</strong> {{ church.location }}</p>
                        {% if church.map_link %}
                            <p><strong>Map Link:</strong> <a href="{{ church.map_link }}" target="_blank" style="color: #3b82f6;">üìç View on Google Maps</a></p>
                        {% endif %}
                        <p><strong>Service Time:</strong> {{ church.service_times }}</p>
                        <div style="margin-top: 10px;">
                            <strong>Church Type:</strong><br>
                            {% if church.is_headquarter_church %}
                                <span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; margin-right: 5px;">HEADQUARTER CHURCH</span>
                            {% endif %}
                            {% if church.is_diosen_church %}
                                <span style="background: #7c3aed; color: white; padding: 4px 8px; border-radius: 4px; margin-right: 5px;">DIOSEN CHURCH</span>
                            {% endif %}
                            {% if church.is_mission_church %}
                                <span style="background: #059669; color: white; padding: 4px 8px; border-radius: 4px; margin-right: 5px;">MISSION CHURCH</span>
                            {% endif %}
                            {% if not church.is_headquarter_church and not church.is_diosen_church and not church.is_mission_church %}
                                <span style="color: #9ca3af;">Regular Church</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Head Teacher:</strong> {{ church.head_teacher_name }}</p>
                        <p><strong>Head Teacher Phone:</strong> {{ church.head_teacher_phone|default:"Not provided" }}</p>
                        <p><strong>Head Teacher Email:</strong> {{ church.head_teacher_email|default:"Not provided" }}</p>
                        <p><strong>Church Phone:</strong> {{ church.phone|default:"Not provided" }}</p>
                        <p><strong>Church Email:</strong> {{ church.email|default:"Not provided" }}</p>
                        <p><strong>Capacity:</strong> {{ church.capacity|default:"Not specified" }}</p>
                        <p><strong>Established:</strong> {{ church.established_date|default:"Not specified" }}</p>
                        <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 4px; margin-top: 10px;">
                            <small style="color: #9ca3af;">
                                <strong>Note:</strong> A Sabbath Day starts on Friday 6:00 PM to Saturday 6:00 PM (24 hours). All Sabbaths are held on Saturday. All Sabbaths MUST end by 6:00 PM Saturday.
                            </small>
                        </div>
                    </div>
                </div>

                {% if church.service_times %}
                <div class="row mt-3">
                    <div class="col-md-6">
                        <p><strong>Service Times:</strong></p>
                        <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 4px;">
                            {{ church.service_times|linebreaks }}
                        </div>
                    </div>
                </div>
                {% endif %}

                {% if church.assistant_teachers %}
                <div class="row mt-3">
                    <div class="col-md-6">
                        <p><strong>Assistant Teachers:</strong></p>
                        <div style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 4px;">
                            {{ church.assistant_teachers|linebreaks }}
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Church Members -->
        <div class="card">
            <div class="card-header">
                <h5 class="card-title">
                    <i class="fas fa-users" style="color: #dc2626; margin-right: 10px;"></i>
                    Church Members ({{ members.count }})
                </h5>
            </div>
            <div class="card-body">
                {% if members %}
                <div class="table-responsive">
                    <table class="table table-dark table-striped" style="background: #1f2937;">
                        <thead style="background: #dc2626;">
                            <tr>
                                <th style="padding: 12px; color: white; border: 1px solid #374151;">Name</th>
                                <th style="padding: 12px; color: white; border: 1px solid #374151;">Phone</th>
                                <th style="padding: 12px; color: white; border: 1px solid #374151;">Email</th>
                                <th style="padding: 12px; color: white; border: 1px solid #374151;">Emergency Contact</th>
                                <th style="padding: 12px; color: white; border: 1px solid #374151;">Membership Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for member in members %}
                            <tr>
                                <td style="padding: 10px; border: 1px solid #374151;">
                                    <strong style="color: #ffffff;">{{ member.first_name }} {{ member.last_name }}</strong>
                                    {% if member.photo %}
                                    <br><small style="color: #9ca3af;">
                                        <i class="fas fa-image" style="margin-right: 5px;"></i>
                                        Has photo
                                    </small>
                                    {% endif %}
                                </td>
                                <td style="padding: 10px; border: 1px solid #374151; color: #e5e7eb;">
                                    {{ member.phone|default:"Not provided" }}
                                </td>
                                <td style="padding: 10px; border: 1px solid #374151; color: #e5e7eb;">
                                    {{ member.email|default:"Not provided" }}
                                </td>
                                <td style="padding: 10px; border: 1px solid #374151; color: #e5e7eb;">
                                    {% if member.emergency_contact_name %}
                                        <strong>{{ member.emergency_contact_name }}</strong><br>
                                        <small>{{ member.emergency_contact_phone|default:"No phone" }}</small>
                                    {% else %}
                                        Not provided
                                    {% endif %}
                                </td>
                                <td style="padding: 10px; border: 1px solid #374151;">
                                    <span style="padding: 4px 8px; border-radius: 4px; font-size: 0.8em;
                                               background: {% if member.membership_status == 'active' %}#10b981{% elif member.membership_status == 'inactive' %}#f59e0b{% else %}#6b7280{% endif %};
                                               color: white;">
                                        {{ member.get_membership_status_display|default:member.membership_status }}
                                    </span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div style="text-align: center; color: #9ca3af; font-style: italic; padding: 40px;">
                    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
                    No members registered for this church yet.
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}